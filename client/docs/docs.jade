template(name='edit_doc')
    with doc
        .ui.padded.stackable.grid
            .centered.row
                .three.wide.center.aligned.column
                    +delete_button
                    +admin_toggle
                .ten.wide.center.aligned.column
                    h1.ui.header
                        if icon_class
                            +icon96 name=icon_class classes='ui image'
                        |Edit 
                        if title
                            |#{title}
                        else
                            |#{parent.title} Item

                .three.wide.center.aligned.column
                    +save_link
            .centered.row
                .ten.wide.column
                    if type
                        +Template.dynamic template=edit_type_template
                    else
                        +parent_doc_segment
                        +edit_content
                        +published
                if is_admin
                    .six.wide.column
                        +edit_title
                        +edit_icon
                        // +edit_child_type
                        +edit_number
                        +published
                        +edit_type


template(name='view_document')
    +edit_content
    +edit_transcript
    +child_docs


template(name='view_doc')
    with doc
        .ui.padded.stackable.grid
            .centered.row
                .three.wide.center.aligned.column
                    +admin_toggle
                .nine.wide.center.aligned.column
                    unless is_site
                        +parent_link
                    else
                        .ui.small.image
                            +view_image_id
                .four.wide.center.aligned.column
                    if currentUser
                        .ui.horizontal.list
                            // .item
                            //     a.ui.icon.basic.white.inverted.circular.button(href="/karma" data-position="bottom center" data-tooltip='Karma')
                            //         +icon48 name='diamond' classes='ui mini inline image'
                            .item
                                a.ui.icon.basic.white.inverted.circular.button(href="/view/q6NwnyH93JB4Dg5K7" data-position="bottom center" data-tooltip='Messaging')
                                    +icon48 name='chat' classes='ui mini inline image'
                            .item
                                a.ui.icon.basic.white.inverted.circular.button(href="/view/Gd7PigcoofFzYdau7" data-position="bottom center" data-tooltip='Notifications')
                                    +icon48 name='bell' classes='ui mini inline image'
                            .item
                                a.ui.icon.basic.white.inverted.circular.button(href="/profile/#{currentUser.username}" data-position="bottom center" data-tooltip=currentUser.username)
                                    if currentUser.profile.image_id
                                        img.ui.mini.image(src="{{c.url currentUser.profile.image_id width=60 height=60 gravity='face' crop='fill'}}")
                                    else
                                        i.user.icon
                    else
                        a.ui.icon.basic.white.inverted.circular.button(href='/sign-in') 
                            +icon48 name='login-rounded-down' classes='ui mini inline spaced image'
                            // | Sign In
        if type
            +Template.dynamic template=view_type_template
        else            
            .ui.padded.stackable.grid
                .row
                    .three.wide.center.aligned.column
                        // +parent_link
                    .ten.wide.column
                        h1.ui.inverted.center.aligned.header 
                            +icon96 name=icon_class classes='ui inline image'
                            |#{title}
                    .three.wide.center.aligned.column
                        if can_edit
                            +edit_button
                .centered.row
                    .ten.wide.column
                        +parent_doc_segment
                        .shadowed-box
                            +view_content
                            +author_info
                            |#{when}