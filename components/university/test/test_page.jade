template(name='test_page')
    with test
        .ui.container
            .ui.breadcrumb
                a.section(href='/') Home
                .divider  / 
                // a.section(href='/courses') Inspire U
                // .divider  / 
                a.section(href="/tests") Tests
                .divider  / 
                .active.section #{title}
            if image_id
                img.ui.centered.image(src="{{c.url image_id height=500 width=800 background='white' crop='lpad'}}")
            h1.ui.header #{title}
            .ui.stackable.divided.grid
                .twelve.wide.column
                    .content
                        if publish_date
                            h4.ui.header Published #{publish_when}
                        .ui.basic.segment
                            h3.ui.dividing.header Description
                            |!{content}
                            h3.ui.dividing.header Statistics
                            if currentUser
                                h3.ui.dividing.header Your Sessions
                                #new_session.ui.basic.teal.button
                                    i.plus.icon
                                    | New Session
                                .ui.hidden.divider
                                .ui.cards
                                    each my_sessions
                                        +session_card
                    // +user_blurb
                    // +comments
                .four.wide.column
                    .ui.dividing.header #{title} Tags
                    each tags
                        .ui.basic.label #{this}
                    if isInRole 'admin'
                        .ui.dividing.header 
                            i.large.red.configure.icon
                            |Admin
                        a.ui.basic.button(href="/edit/#{_id}")
                            i.pencil.icon
                            |Edit Test
                        if published
                            .ui.green.label Published
                        else
                            .ui.red.label Unpublished                        
                    .ui.dividing.header Actions
                    // +voting
                    // +favorite
                    // +tag_rating


template(name='session_card')
    .ui.card
        .content
            a.header(href="/test/#{test_id}/session/#{_id}") #{long_date}
            // .description
            //     |#{long_date}
        .content
            each results
                .ui.teal.tiny.progress(data-percent=category_percent)
                    .bar
                    .progress
                    .label #{category}